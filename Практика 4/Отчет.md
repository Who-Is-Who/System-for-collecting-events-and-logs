# Практическая работа № 4: Network Threat Hunting
## Выполнил Панков Никита Олегович, группа ББМО-01-23
## Ход работы

## Первый набор данных

1) Поднимаем вирутальную машину из заранее заготовленного образа. После запуска виртуальной машины заходим в браузер и видим приветственное окно

![image](Фото/1.png)

2) Используем полученные данные и входим в учетную запись. Посе входа нас просит выбрать датасет с которым мы будем работать

![image](Фото/2.png)

3) В системе уже храняться готвоые датасеты с которыми мы будем работвть (lab1, lab2, lab3). Загружаем первый датасет

![image](Фото/3.png)

4) После загрузки выбираем его и нам открываеться рабочая панель с нашими данными

![image](Фото/4.png)

5) Начнем анализировать наши данные

5.1) Первая запись: Значение beacon score очень высокое, пользовательскйи агент определлися как Windows 7, за последний день наблюдается большое колличество подключений, отсуствует строка хостинг

5.2) Вторая запись: Значение beacon низкое, есть легетимный сертификат, анализ в гугле показал что данная запись принадлежит Windows и считаеться легитимной 

![image](Фото/5.png)

5.3) Третья запись: Значение beacon низкое, принадлежит Wts (Windows tile services)

![image](Фото/6.png)

5.4) Четвертая запись: Значение beacon низкое, имеет схожесть со второй записью

![image](Фото/7.png)

5.5) Пятая запись: Значение beacon низкое, имеет схожесть с предыдущими записями

![image](Фото/8.png)

5.6) Шестая запись: Значение beacon низкое, имеет схожест с четвертой записью

![image](Фото/9.png)

6) после анализа записей сталдо ясно что первая выглядит довольно подозрительно и требует детального анализа, оставшиеся записи относятся к службам виндовс

7) Для дальнейшего анализа внесем легетимные на наш взгляд записи в safelist

![image](Фото/10.png)

![image](Фото/11.png)

![image](Фото/12.png)

![image](Фото/13.png)

![image](Фото/14.png)

8) После внесения в safelist перейдем во вкладку длительные подключения и начнем анализировать

![image](Фото/15.png)

9)  Видим 2 записи ккаждая из которых имеет продолжительность почти сутки. Проанализируем их через Virustotal

10)  Открыв превую запись видим сразу предупреждение об этом ip адрессе

![image](Фото/16.png)

11)  Перейдя по этому адрессу видим такое же приветсвенное окно как и у нас

![image](Фото/17.png)

12)  Открыв вторую запись видим что данный ip адресс легетимный

![image](Фото/18.png)

13)  Следующим этапом посмотрим логи связанные с данной записью и ip адрессом

![image](Фото/19.png)

![image](Фото/20.png)

![image](Фото/21.png)

Проведя весь анализи мы получили следующую иформацию: 
a) Количество соединений: 3011
b) Cтрока агента пользователя была подвержена изменению
с) Отсуствие поля "host"
d) Строка URI имеет длинный и запутанный вид

Вывод: Соединения 104.248.234.238 явно является нелегитимным

## Второй набор данных

1) Загружаем второй набор данный. После загрузки система сразу нас предупреждает что возможно C2 через DNS

![image](Фото/22.png)

![image](Фото/23.png)

2) Открываем вкладуку DNS для анализа

![image](Фото/24.png)

![image](Фото/25.png)

Проведя весь анализи мы получили следующую иформацию: 
a) Возможно C2 через DNS
b) Имя хоста состоит из шестнадцатеричных символов
с) Отсуствие отдельных IP адресов

## Третий набор данных

1) Загружаем третий набор данный. Сразу видим что рейтинг равняется 100

![image](Фото/26.png)

![image](Фото/27.png)

2) Переходим в раздел beacons web для анализа

![image](Фото/28.png)

3) Видим запись с большим значение beacon. Домен хоть и похож на оригинальный скайп новсе-таки он отличается.

4) Так же как и первой части проверим черех virustotal и видим что данный домент помечен как ненадёжный

![image](Фото/29.png)

5)  Переходим во вкладку длительные подулючения и видим такую же ситуацию как и в первом наборе данных

![image](Фото/30.png)

![image](Фото/31.png)

![image](Фото/32.png)

Вывод: делаем заключение что данный адрес является вредоносным



